<main>
  <div class="container" id="headerBelowNav">
    <h1>REGISTER</h1>
  </div>
  <div id="borderLine">
    <p id="borderHeaderSection">Registration Form</p>
    <form name="register" method="POST" action="/registration" onsubmit="return validateForm();">
      <div class="container" id="firstNameSection">
        <div class="row">
          <label class="form-label col-sm-2 mb-3" for="stud_id"><b>First Name</b></label>
          <div class="col-sm-10 mb-3">
            <input type="text" class="form-control" name="firstname" id="firstname" placeholder="Your first name" required><span id="message2"></span>
          </div>
          <label class="form-label col-sm-2 mb-3" for="stud_id"><b>Last Name</b></label>
          <div class="col-sm-10 mb-3">
            <input type="text" class="form-control" name="lastname" id="lastname" placeholder="Your last name" required><span id="message2"></span>
          </div>
          <label class="form-label col-sm-2 mb-3" for="stud_id"><b>User Name:</b></label>
          <div class="col-sm-10 mb-3">
            <input type="text" class="form-control" name="username" id="username" placeholder="Please enter a user name" required><span id="message2"></span>
          </div>
        </div>
      </div>
      <div class="container" id="passwordSectionRegister">
        <div class="row">
          <div class="col-sm-2 mb-3">
            <label for="stud_name" class="form-label"><b>Password:</b></label>
          </div>
          <div class="col-sm-10 mb-3">
            <input type="password" class="form-control" name="password" id="password" placeholder="Please enter a password" required><span id="message3"></span>
          </div>
        </div>
      </div>
      <input class="btn" type="submit" id="registrationbutton" value="Register" onclick="return validateForm()">
      <input class="btn" type="reset" id="resetbutton" value="Reset">
    </form>
        </div>
      </div>
    </div>
  </div>
  </div>
 </div>
 <script>
  function validateForm() {
      let firstName = document.getElementById("firstname").value;
      let lastName = document.getElementById("lastname").value;
      let username = document.getElementById("username").value;
  
      if (firstName.length == 0) {
          let message = document.getElementById("message");
          message.innerHTML = "<em>You didn't enter your first name.</em>";
          message.classList.add("text-danger");
          return false;
      }
  
      if (lastName.length == 0) {
          let message = document.getElementById("message1");
          message.innerHTML = "<em>You didn't enter your last name.</em>";
          message.classList.add("text-danger");
          return false;
      }
  
      if (username.length == 0) {
          let message = document.getElementById("message2");
          message.innerHTML = "<em>You didn't enter a username.</em>";
          message.classList.add("text-danger");
          return false;
      }
  
      let password = document.getElementById("password").value;
  const minLength = 8;
  const minUpperChars = 1;
  const minLowerChars = 1;
  const minDigits = 1;
  
  // Updated regex to require at least one special character
  const specialCharRegex = /[!@#$%^&*]+/;
  
  // Check if the password meets the minimum length requirement
  if (password.length < minLength) {
    let message = document.getElementById("message3");
    message.innerHTML = "<em>Password must be at least 8 characters long.</em>";
    message.classList.add("text-danger");
    return false;
  }
  
  // Check if the password contains the required character types
  let charTypeCount = 0;
  if (/[A-Z]/.test(password)) charTypeCount++;
  if (/[a-z]/.test(password)) charTypeCount++;
  if (/[0-9]/.test(password)) charTypeCount++;
  if (specialCharRegex.test(password)) charTypeCount++;
  
  // Check if the password meets all the requirements
  if (
    charTypeCount < minUpperChars + minLowerChars + minDigits + 1 // Require at least one special character
  ) {
    let message = document.getElementById("message3");
    message.innerHTML =
      "<em>Password must contain at least one uppercase letter, one lowercase letter, one digit, and one special character.</em>";
    message.classList.add("text-danger");
    return false;
  }
  
  // Clear any previous error message
  let message = document.getElementById("message3");
  message.innerHTML = "<em>Password is valid.</em>";
  message.classList.remove("text-danger");
  message.classList.add("text-success");
  return true;
  }
  
  </script>
      </main>